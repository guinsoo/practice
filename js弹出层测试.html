<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<meta http-equiv="Content-Type" content="text/html; charset=gbk" />
  <head>
		<title>js弹出层测试</title>
	</head>
	<style>
		*{margin:0;}
		 
		.main{width:100%;height:100%;position:relative;}
		 .main p{text-align:center;}
		#div2{width:450px;height:350px;background-color:#E6E6E6;position:absolute;top:100px;left:35%;z-index:999;display:none}
		.close{border:none;background:url(close.jpg) no-repeat;display:block;position:absolute;z-index:999;right:2px;top:2px;height:20px;width:19px;}
		#cboxOverlay{background:#000;position:absolute;z-index:999; top:0;}
		 
	</style>
	<script type="text/javascript">
	window.onload=function(){
		var doc = document; 
		var oDiv=doc.getElementById("div2");
		var oBut1=doc.getElementById("but1");
		var oBut2=doc.getElementById("but2");
		var oOver=doc.getElementById("cboxOverlay");
		var flag=false;
		
		//监听页面大小变化
		function davResize(){  
			(flag) && (showBox());
		} 
	
		//监听器
		function myAddEvent(obj, ev, fn){ 
			if(obj.attachEvent) {//IE 
				obj.attachEvent('on'+ev, fn); 
			}else { 
				obj.addEventListener(ev, fn, false); 
			} 
		} 
		
		//设置透明度函数
		function setOpacity(elem,l){
			if (elem.filters) {
				elem.style.filter ="alpha(opacity="+l+")";
			} else {
				elem.style.opacity = l/100;
			}
		}
		
		//弹出层显示方法
		function showBox(){
			var docE = doc.documentElement,docB = doc.body,hHeight = 0,wWidth = 0;
			//这个判断感觉有点恶心
			hHeight = Math.max(docE.clientHeight+docE.scrollTop,docB.clientHeight+docB.scrollTop)+'px';
			wWidth = Math.max(docE.clientWidth+docE.scrollLeft,docB.clientWidth+docB.scrollLeft)+'px';
			
			oDiv.style.display="block";
			oOver.style.display="block";		 
			oOver.style.width=wWidth;
			oOver.style.height=hHeight;
			setOpacity(oOver,90);
		}
		
		//弹出层隐藏方法
		function hideBox(){
			oDiv.style.display="none";
			oOver.style.display="none";
			oOver.style.width=0;
			oOver.style.height=0;
			flag=false;
		}
		
		//取消弹出层
		function dis(e){
			myAddEvent(e,'click',hideBox);
		}
		
		dis(oOver);
		dis(oBut2);
		davResize();
		myAddEvent(window, 'resize',davResize);
		
		 //点击按钮，弹出层出现
		myAddEvent(oBut1,'click',function(){ 
			showBox();
			flag=true;
		});
		
	} 
	</script>
	<body>
	<div class="main">
	<p>dsfasfsdf</p>
	<p><input type="button" id="but1" align="center" value="click"></p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<p>hfoiashdfsfoishdfosadfosjdfoisjdfjsidjfoasjdfoasjdfojasdofjosajfoajsofd</p>
	<div id="cboxOverlay">
	</div>
	<div id="div2">
	<input type="button"  class="close" id="but2" value="">
	这里是弹出层
	</div>
	</div>
	</body>
</html>
